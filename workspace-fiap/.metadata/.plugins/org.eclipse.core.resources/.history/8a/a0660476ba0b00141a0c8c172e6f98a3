package br.com.fiap.java.servico;

/**
 * Import do arquivos externos utilizados na classe
 */
import java.util.Date;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.swing.JOptionPane;

import br.com.fiap.java.exception.NegocioException;
import br.com.fiap.java.io.AtividadeArquivo;
import br.com.fiap.java.util.Util;

/**
 * @author Turma Fiap 23SCJ
 */
public class ServicoMensagem {
	/**
	 * Atributo - Logger
	 */
	Logger logger = Logger.getLogger(this.getClass().getName());

	/**
	 * Método salvar
	 * 
	 * @param atividade
	 */
	public void codificar(String mensagem) {
		logger.setLevel(Level.ALL);
		logger.log(Level.INFO, "Método salvar()");
		StringBuilder sb = new StringBuilder();
		sb.append(Util.dataParaArquivo(atividade.getDataInicio()));
		sb.append(";");
		sb.append(Util.dataParaArquivo(atividade.getDataFim()));
		sb.append(";");
		sb.append(atividade.getNome());
		sb.append(";");
		sb.append(atividade.getLocal());
		Map<Date, Atividade> mapa = controle();
		Atividade atividadeRegistrada = mapa.get(atividade.getDataInicio());
		try {
			if (atividadeRegistrada != null) {
				int resp = JOptionPane
						.showConfirmDialog(null,
								"Este evento já existe na data solicitada! Deseja inclui-lo?");
				if (resp == 0) {
					AtividadeArquivo.getInstance().escreverAtividades(
							sb.toString());
				} else {
					JOptionPane.showMessageDialog(null, "Evento discartado");
				}
			} else {
				AtividadeArquivo.getInstance()
						.escreverAtividades(sb.toString());
			}
		} catch (NegocioException e) {
			JOptionPane.showMessageDialog(null, e.getMessage());
		}
	}
}
