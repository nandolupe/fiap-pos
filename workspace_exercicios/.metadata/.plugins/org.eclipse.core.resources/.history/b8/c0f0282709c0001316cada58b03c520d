package com.exercicios.persistence;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class BaseDAO {

	private static String URL_CONNECTION = "jdbc:mysql://localhost/fj21";
	private static String USER = "root";
	private static String PASSWORD = "";

    protected Connection getConnection() {

    	Connection connection = null;
    	try {

    		connection = DriverManager.getConnection(URL_CONNECTION, USER, PASSWORD);

        } catch (SQLException e) {
        	System.out.println("Erro ao fechar a conexão com o banco de dados!");
        	e.printStackTrace();
        }

    	return connection;
    }

    protected void closeConnection(Connection connection, PreparedStatement prst, ResultSet rs) {

    	try {

    		// FECHANDO O RESULT SET
			if (rs != null && !rs.isClosed()) {
				rs.close();
			}

			// FECHANDO O PREPARESTATEMENT
			if (prst != null && !prst.isClosed()) {
				prst.close();
			}

			// FECHANDO A CONNECTION
			if (connection != null && !connection.isClosed()) {
				connection.close();
			}
		} catch (SQLException e) {
			System.out.println("Erro ao fechar a conexão com o banco de dados!");
			e.printStackTrace();
		}

    }
}
